###  Changes

#### 2025-12-28 [15:50]
* **Refactor: VBE Graphics Mode Handling**
    - Commented out automatic VBE 1280x720 mode initialization in `boot.asm` to prevent automatic graphics mode on boot.
    - Mode `0x411B` (1280x720, 24/32-bit with LFB) now requires explicit manual triggering instead of auto-initialization.
* **Optimization**: 
    - Removed complex graphics mode implementation to maintain system stability and text mode reliability.
    - Kept text-based menu system as primary interface.
* **F8 Key**: 
    - Reserved for future graphics mode implementation (currently displays placeholder message).

#### 2025-12-28 [14:58]
* **Bugfix: Resolved Linker/Scope Error E0425**
    - Zdefiniowano brakujc funkcj `get_font_ptr`.
    - Dodano pierwsze bitmapy glif贸w (A, B, Crab) do statycznej pamici kernela.
* **Refactor**: 
    - Zmieniono `draw_glyph`, aby poprawnie iterowaa po 16 rzdach bitmapy, zapewniajc wsparcie dla standardowych wymiar贸w fontu konsolowego.
* **Feature: Software Font Renderer**
    - Zaimplementowano funkcj `draw_glyph` do rysowania bitmap 8x16 w trybie LFB.
    - Dodano mapowanie bitowe (bit-shifting) dla glif贸w, umo偶liwiajce renderowanie znak贸w piksel po pikselu.
* **Graphics**:
    - Wprowadzono obsug kolor贸w 24-bit RGB w trybie graficznym.
    - Przygotowano baz pod customowe fonty i emoji.

#### 2025-12-28 [14:50]
* **Strategy: UTF-8 & Graphics Roadmap**
    - Rozwa偶ono przejcie na tryb graficzny (Framebuffer) w celu obsugi emoji.
    - Zdefiniowano potrzeb stworzenia Software Renderera dla glif贸w o zmiennej szerokoci.
    - Zarezerwowano adres `0x508` na flag aktywnego kodowania znak贸w.

#### 2025-12-28 [14:35]
* **Feature: Modifier Key Support**
    - Dodano obsug kodu skanowania dla lewego klawisza CTRL (0x1D).
    - Wprowadzono system ledzenia stanu klawiszy modyfikujcych pod adresem `0x507`.
* **Logic Update**: 
    - Przygotowano architektur pod obsug kombinacji klawiszy (Combo-keys).
* **Feature: Buffer-to-VGA Output**
    - Zaimplementowano odczyt bufora RAM (adres 0x600) po zatwierdzeniu klawiszem Enter.
    - Dodano dynamiczne wywietlanie wpisanej komendy na pozycji (0, 22) przed resetem stanu.
* **Logic Fix**: 
    - Rozwizano problem "znikajcych danych" poprzez wprowadzenie ptli iterujcej po fizycznych adresach pamici przed wyczyszczeniem licznika dugoci (0x505).

#### 2025-12-28 [14:30]
* **Architecture: Multi-level State Machine**
    - Wprowadzono adres `0x506` jako flag `INPUT_MODE`.
    - Zaimplementowano izolacj klawiatury: klawisze alfanumeryczne s procesowane tylko przy aktywnym `INPUT_MODE`.
* **UI/UX Enhancement**: 
    - Dodano obsug klawisza ESC (0x01) jako wyjcie z trybu wpisywania bez zapisu.
    - Dodano obsug Backspace (0x0E) z dynamiczn aktualizacj bufora RAM i pamici VGA.
* **Memory Map**:
    - `0x500`: Menu State
    - `0x505`: Input Length
    - `0x506`: Input Mode Toggle (0/1)
* **Knowledge: Keyboard Mapping Expansion**
    - Dodano obsug kodu skanowania dla klawisza 'I' (0x17).
* **Development Status**: 
    - Rozszerzono tablic mapowania ASCII o kolejne litery alfabetu, przygotowujc system pod obsug penych komend tekstowych.

#### 2025-12-28 [01:00]
* **Code Optimizations**
* **Build: Multiboot size flags**
    - W `make_multiboot.sh` dodano `--gc-sections`, strip w `objcopy` oraz optymalizacje rozmiaru w `RUSTFLAGS`, usuwajc konflikt `lto`/`embed-bitcode`.
    - Dodano cie偶k budowy kernela w trybie Multiboot (elf/bin w `release/multiboot/`).
* **UI: Migajcy prostokt (Key 4)**
    - Animacja trzech kolor贸w (niebieski/czerwony/zielony) z op贸藕nieniem ~800ms zachowana, uproszczona bez tablic i ptli dla mniejszego kodu.
* **Binary size**
    - Zmniejszono narzut kodu generowanego przez ptle/zmienne w animacji, co uatwia utrzymanie binarki ~25 KB.

#### 2025-12-28 [00:30]
* **Build: GRUB ISO script**
    - Dodano skrypt `make_iso.sh` generujcy obraz ISO z GRUB i kernel Multiboot (pliki w `release/multiboot/isodir` oraz `release/rusted.iso`).

###  Changes

#### 2025-12-27 [23:25]
* **Feature: Unified Keyboard Polling & State Management**
    - Zaimplementowano makro `poll_keyboard_unified!`, kt贸re obsuguje logik klawiatury w zale偶noci od stanu menu.
    - Wprowadzono system stan贸w (State Machine) przechowywany pod statycznym adresem `0x500` (0: Main Menu, 1: Math Menu).
    - Dodano mechanizm "last scancode" pod adresem `0x501`, eliminujcy powtarzanie akcji przy trzymaniu klawisza.
* **Feature: Interactive Math Menu**
    - Dodano dedykowany tryb oblicze matematycznych (`menu_state == 1`).
    - Zaimplementowano operacje: dodawanie, odejmowanie, mno偶enie i dzielenie z dynamicznym wywietlaniem wynik贸w ASCII.
    - Zintegrowano generator liczb losowych (`get_random!`) z formatowaniem dziesitnym (obsuga dziesitek i jednoci).
* **Feature: Secrets & Animations**
    - Dodano sekwencj powitaln "Welcome on Board" pod klawiszem `9` w Main Menu.
    - Wprowadzono blokad animacji (`anim_lock`) pod adresem `0x503`, zapobiegajc nakadaniu si proces贸w graficznych.
    - Dodano sygnatur autora: `by Klubuntu (github.com/klubuntu)`.

#### 2025-12-27 [23:05]
* **Feature: PRNG (Pseudo-Random Number Generator)**
    - Zaimplementowano generator LCG (Linear Congruential Generator) operujcy na 64-bitowym ziarnie.
    - Dodano obsug instrukcji `rdtsc` przez ASM do inicjalizacji ziarna (seeding).
    - Stworzono makro `get_random!`, udostpniajce losowe liczby `u64` w caym kernelu.
* **Safety**: Zastosowano operacje `wrapping`, aby unikn bd贸w przepenienia (integer overflow) podczas generowania liczb.

#### 2025-12-27 [21:40]
* **Fix: VMA Address & Code Model**
    - Zmieniono `code-model` w `target.json` z `kernel` na `small`.
    - Rozwizano problem bdnego adresowania (przesunicie o 2MB), wymuszajc poprawne VMA dla sekcji `.text` na poziomie `0x8000`.
* **Optimization: Binary Cleanup**
    - Dodano sekcj `/DISCARD/` w `link.ld` dla `.debug*`, `.comment` i `.eh_frame`.
    - Zastosowano flagi `-j .text -j .rodata -j .data` w `llvm-objcopy`.
    - Wyeliminowano metadane i mieci binarne z pocztku pliku `.bin`, zapewniajc poprawny start kernela.
* **Feature: Multi-color VGA Macro**
    - Rozbudowano makro `vga_print_ext`, wykorzystujc rejestry `RSI` (tekst) oraz `RDX` (kolory).
    - Zastosowano bezpieczn ptl sprawdzajc null-terminator przed pobraniem koloru, zapobiegajc odczytom poza zakresem tablicy.
    - Wprowadzono `inout` dla rejestr贸w w bloku `asm!`, co wyeliminowao konflikty z LLVM.
* **Architecture: Stack Initialization & Global ASM**
    - Zastpiono funkcj `_start` (naked) blokiem `global_asm!`.
    - Zdefiniowano bezpieczny stos o rozmiarze 16 KB w sekcji `.bss`.
    - Ustawiono `RSP` za pomoc `lea rsp, [stack_top]` oraz wyr贸wnano stos do 16 bajt贸w.
    - Umo偶liwiono bezpieczne przekazywanie tablic tymczasowych (lokalnych) bezporednio w argumentach makr.

#### 2025-12-26
* **Enhancement: Nuclear Reboot Sequence**
    - Zaimplementowano wielostopniowy mechanizm restartu (F5):
        1. Port PCI `0xCF9` (Standard QEMU).
        2. Kontroler klawiatury `0x64` (Standard PS/2).
        3. Wymuszenie `Triple Fault` poprzez celowe uszkodzenie tablicy IDT (`lidt [rsp]`), gwarantujce restart w ka偶dym rodowisku.

#####  Benefits of Optimizations
* **Minimalny rozmiar binarki**: Usunicie sekcji debugowych i komentarzy zmniejsza sporo rozmiar pliku `.bin`, co pozwala na szybsze adowanie przez bootloader z ograniczon liczb sektor贸w.
* **Stabilno pamici (Memory Safety)**: Dziki rezerwacji stosu w sekcji `.bss`, mamy pewno, 偶e dane lokalne Rusta nie nadpisz kodu kernela ani wa偶nych struktur danych BIOS/UEFI.
* **Poprawne linkowanie symboli**: Model kodu `small` gwarantuje, 偶e relatywne skoki i adresowanie danych (RIP-relative addressing) dziaaj poprawnie w obrbie pierwszych 2GB pamici RAM.
* **Predictable Execution**: Usunicie mieci z pocztku pliku sprawia, 偶e pod adresem `0x8000` zawsze znajduje si instrukcja wejcia (`_start`), co eliminuje ryzyko pr贸by wykonania przez procesor tekstowych metadanych jako kodu.
* **Feature: Advanced Animated Clear**
    - Zaktualizowano makro `vga_clear_animated!` o obsug dowolnej liczby znak贸w.
    - Wprowadzono automatyczne zawijanie wierszy (word wrap) podczas czyszczenia.
    - Zoptymalizowano ptl op贸藕niajc w ASM, by dopasowywaa tempo animacji do liczby znak贸w.
* **Reduced size from 28KB to 17KB**